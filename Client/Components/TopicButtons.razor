@using Microsoft.AspNetCore.Components.Authorization
<div class="topic-buttons">
    <button @onclick="() => OnToggleComments.InvokeAsync(Topic.Id)">See Comments (@Topic.CommentNum)</button>
    @if (Topic.Status == Status.Active)
    {
        <AuthorizeView>
            <Authorized>
                <button @onclick="() => OnToggleAddComment.InvokeAsync(Topic.Id)">Add Comment</button>
                @if (UserId == Topic.UserId)
                {
                    <button @onclick="() => OnToggleEditTopic.InvokeAsync(new UpdateTopicModelDto(Topic.Id, Topic.Title, Topic.Body))">Edit</button>
                    <button class="delete" @onclick="() => OnDeleteTopic.InvokeAsync(Topic.Id)">Delete</button>
                }
            </Authorized>
            <NotAuthorized>
                <button @onclick="NavigateToLogin">Add Comment</button>
            </NotAuthorized>
        </AuthorizeView>
    }
</div>

@code {
    [Parameter] public TopicWithContentResult Topic { get; set; }
    [Parameter] public EventCallback<int> OnToggleComments { get; set; }
    [Parameter] public EventCallback<int> OnToggleAddComment { get; set; }
    [Parameter] public EventCallback<UpdateTopicModelDto> OnToggleEditTopic { get; set; }
    [Parameter] public EventCallback<int> OnDeleteTopic { get; set; }
    [Parameter] public Action NavigateToLogin { get; set; }
    [Parameter] public int? UserId { get; set; }
}
